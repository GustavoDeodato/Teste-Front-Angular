<div class="page">
  <div class="header">
    <button class="btn-back" (click)="goBack()">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
        <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Voltar
    </button>
  </div>

  @if (loading) {
    <div class="loading">Carregando...</div>
  }

  @if (!loading) {
    <div class="content">
      <h1>{{ isEditMode ? 'Editar Item' : 'Novo Item' }}</h1>
      <p class="subtitle">{{ isEditMode ? 'Atualize as informações do item' : 'Preencha as informações do novo item do inventário' }}</p>

      <form (ngSubmit)="onSubmit()">
        <div class="form-grid">
          <div class="form-group">
            <label>Nome do Item *</label>
            <input type="text" [(ngModel)]="formData.nome" name="nome" placeholder="Digite o nome do item" [class.error]="errors.nome">
            @if (errors.nome) {
              <span class="error-msg">{{errors.nome}}</span>
            }
          </div>

          <div class="form-group">
            <label>SKU *</label>
            <input type="text" [(ngModel)]="formData.sku" name="sku" placeholder="Ex: SKU-001" [class.error]="errors.sku">
            @if (errors.sku) {
              <span class="error-msg">{{errors.sku}}</span>
            }
          </div>

          <div class="form-group">
            <label>Categoria *</label>
            <select [(ngModel)]="formData.categoriaId" name="categoriaId" [class.error]="errors.categoriaId">
              <option [value]="0">Selecione uma categoria</option>
              @for (cat of categories; track cat.id) {
                <option [value]="cat.id">{{cat.nome}}</option>
              }
            </select>
            @if (errors.categoriaId) {
              <span class="error-msg">{{errors.categoriaId}}</span>
            }
          </div>

          <div class="form-group">
            <label>Status *</label>
            <input type="text" [(ngModel)]="formData.status" name="status" placeholder="Ex: Ativo">
          </div>

          <div class="form-group">
            <label>Quantidade *</label>
            <input type="number" [(ngModel)]="formData.quantidade" name="quantidade" placeholder="0" min="0" [class.error]="errors.quantidade">
            @if (errors.quantidade) {
              <span class="error-msg">{{errors.quantidade}}</span>
            }
          </div>

          <div class="form-group">
            <label>Preço Unitário *</label>
            <input type="number" [(ngModel)]="formData.preco" name="preco" placeholder="0.00" step="0.01" min="0" [class.error]="errors.preco">
            @if (errors.preco) {
              <span class="error-msg">{{errors.preco}}</span>
            }
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-cancel" (click)="goBack()" [disabled]="submitting">Cancelar</button>
          <button type="submit" class="btn-submit" [disabled]="submitting">
            {{ submitting ? 'Salvando...' : (isEditMode ? 'Atualizar Item' : 'Salvar Item') }}
          </button>
        </div>
      </form>
    </div>
  }
</div>
