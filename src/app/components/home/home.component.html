<div class="container">
  <header class="header">
    <div class="header-left">
      <h1>Itens do Inventário</h1>
      <p>Gerencie todos os itens do seu estoque</p>
    </div>
    <button class="btn-new" (click)="addNewItem()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
      Novo Item
    </button>
  </header>

  <div class="filters">
    <div class="search">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="11" cy="11" r="8"></circle>
        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
      <input type="text" placeholder="Buscar por nome, SKU..." [(ngModel)]="searchTerm">
    </div>

    <div class="filter-group">
      <select [(ngModel)]="selectedCategory">
        <option value="all">Todas as categorias</option>
        @for (cat of categoryNames; track cat) {
          @if (cat !== 'all') {
            <option [value]="cat">{{cat}}</option>
          }
        }
      </select>

      <select [(ngModel)]="selectedLocation">
        <option value="all">Todas as localizações</option>
        @for (loc of locations; track loc) {
          <option [value]="loc">{{loc}}</option>
        }
      </select>

      <select [(ngModel)]="selectedStatus">
        <option value="all">Todos os status</option>
        <option value="Ativo">Ativo</option>
        <option value="Inativo">Inativo</option>
      </select>

      <button class="btn-clear" (click)="clearFilters()">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
        Limpar
      </button>
    </div>
  </div>

  @if (loading) {
    <div class="loading">Carregando...</div>
  }

  @if (!loading) {
    <div class="grid">
      @for (item of filteredItems; track item.id) {
        <div class="card" (click)="openItem(item)">
          <div class="card-header">
            <span class="badge">{{item.status}}</span>
          </div>
          
          <div class="card-content">
            <h3>{{item.nome}}</h3>
            @if (item.sku) {
              <span class="sku">SKU: {{item.sku}}</span>
            }
            <p class="desc">{{item.categoria.descricao || item.categoria.nome}}</p>

            <div class="meta-info">
              @if (item.localizacao) {
              <div class="meta-row">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                <span>{{item.localizacao}}</span>
              </div>
              }
            </div>
          </div>

          <div class="card-footer">
            <div class="footer-block">
              <span class="label">Quantidade</span>
              <span class="value-qty">{{item.quantidade}} un</span>
            </div>
            <div class="footer-block align-right">
              <span class="label">Preço Unit.</span>
              <span class="value-price">R$ {{item.preco.toFixed(2)}}</span>
            </div>
          </div>
        </div>
      }
    </div>

    @if (filteredItems.length === 0) {
      <div class="empty">Nenhum item encontrado</div>
    }
  }
</div>